<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Shorts</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <section class="as_main">
    <div class="video_cnt" id="videocnt">

      <video class="as_video" id="mv1" preload="auto" onclick="ToggleVideo(this.id)">
        <source src="https://www.appsloveworld.com/wp-content/uploads/2018/10/640.mp4" type='video/mp4'>
      </video>
      <video class="as_video" id="mv2" preload="auto" onclick="ToggleVideo(this.id)">
        <source src="https://www.appsloveworld.com/wp-content/uploads/2018/10/640.mp4" type='video/mp4'>
      </video>
      <video class="as_video" id="mv3" preload="auto" onclick="ToggleVideo(this.id)">
        <source src="https://www.appsloveworld.com/wp-content/uploads/2018/10/640.mp4" type='video/mp4'>
      </video>
    
    </div>
  </section>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
  <script src="array.js"></script>
  <script> 



const videocnt = document.getElementById("videocnt");

videocnt.addEventListener('scroll', function(e) {
  var videoInsideDiv = videocnt.querySelectorAll("video");
  document.querySelectorAll('video').forEach(vid => vid.pause());
  var lastVideoNum = videoInsideDiv.length - 1;
  var lastVideo = videoInsideDiv[lastVideoNum];
  var lastVideoID = lastVideo.id;
  var lastVideoOffset = $("#" + lastVideoID).offset();
  var lastVideoOffsetTop = lastVideoOffset.top;
  var videoContDim = videocnt.getBoundingClientRect();
  var videoContHeight = videoContDim.height;
  if (lastVideoOffsetTop == videoContHeight) {
    CreateVideo();
  }
  document.querySelectorAll('video').forEach(vid => PlayVideo(vid));
});

function PlayVideo(videoid) {
  if ($("#" + videoid.id).offset().top == 0) {
    document.getElementById(videoid.id).play();
  }
}


function GetVideoSRC() {
    var videosarray = myVideos;
    var videosLength = videosarray.length;
    var minLength = 1;
    var randomnumber = Math.floor(Math.random() * (videosLength - minLength + 1)) + minLength;
    return videosarray[randomnumber];
}



function CreateVideo() {
  var videoInsideDiv = videocnt.querySelectorAll("video");
  var lastVideoNum = videoInsideDiv.length;
  var lastVideoIDNum = lastVideoNum + 1;
  var finalVideoID = "mv" + lastVideoIDNum;
  var createdElement = document.createElement("video");
  createdElement.setAttribute("class", "as_video");
  createdElement.setAttribute("id", finalVideoID);
  createdElement.setAttribute("preload", true);
  createdElement.loop = true;
  createdElement.controls = false;
  createdElement.muted = false;
  var vidSource = document.createElement("source");
  vidSource.src = GetVideoSRC();
  vidSource.type = "video/mp4";
  createdElement.appendChild(vidSource);
  videocnt.appendChild(createdElement);
  createdElement.load();
}

function SetVideos() {
  document.querySelectorAll('video').forEach(vid => setSRC(vid));
}

function setSRC(videoid) {
  document.getElementById(videoid.id).src = GetVideoSRC();
}

function ToggleVideo(videoPlayerID) {
  console.log(videoPlayerID);
}
</script>
  
</body>
</html>
